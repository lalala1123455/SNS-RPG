<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>SNS-RPG Â«EchoesÂ» â€” Unique Posts Edition</title>
  <style>
    body{font-family:system-ui, sans-serif; background:#f6f7f9; margin:0; padding:0;}
    header{background:#4f46e5; color:#fff; padding:12px 20px; display:flex; justify-content:space-between; align-items:center;}
    h1{font-size:20px; margin:0;}
    header button{background:#6366f1; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer; font-size:13px;}
    header button:hover{opacity:.9;}

    #app{max-width:600px; margin:0 auto; padding:16px;}
    #stats{background:#fff; border-radius:12px; padding:12px; box-shadow:0 2px 6px rgba(0,0,0,.08); margin-bottom:16px;}
    #feed article{background:#fff; border-radius:12px; padding:12px 14px; margin-bottom:12px; box-shadow:0 1px 4px rgba(0,0,0,.06);}    
    .author{font-weight:600;}
    .msg{margin:6px 0 8px; line-height:1.4;}
    .actions button{border:none; background:none; cursor:pointer; margin-right:8px; font-size:14px;}
    .actions button:hover{opacity:0.8;}
    .like::before{content:"â™¡"; margin-right:4px;}
    .comment::before{content:"ğŸ’¬"; margin-right:4px;}
    .liked{color:#e11d48;}
    #levelUp{background:#fef08a; padding:10px; border-radius:8px; margin-bottom:12px; display:none;}
    #loader{background:#e0e7ff; border-radius:8px; padding:8px 12px; margin-bottom:12px; font-size:14px;}

    .choiceBox{margin-top:8px;}
    .choiceBox button{background:#4f46e5; color:#fff; border:none; border-radius:6px; padding:6px 10px; margin:4px 6px 4px 0; font-size:13px; cursor:pointer; box-shadow:0 1px 3px rgba(0,0,0,.15);}    
    .choiceBox button:hover{opacity:.9;}

    /* Profile modal */
    #profileOverlay{position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; justify-content:center; align-items:center;}
    #profileBox{background:#fff; border-radius:12px; padding:20px 24px; width:90%; max-width:360px; box-shadow:0 4px 12px rgba(0,0,0,.2);}    
    #profileBox h2{margin-top:0; font-size:18px;}
    #profileBox button{background:#ef4444; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer;}
    #profileBox button:hover{opacity:.9;}
  </style>
</head>
<body>
  <header>
    <h1>Echoes â€” SNS-RPG</h1>
    <button id="profileBtn">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</button>
  </header>

  <div id="app">
    <div id="stats"></div>
    <div id="levelUp"></div>
    <div id="loader">ğŸ¤– ãƒã‚¹ãƒˆã‚’ç”Ÿæˆä¸­â€¦</div>
    <section id="feed"></section>
  </div>

  <!-- Profile Modal -->
  <div id="profileOverlay">
    <div id="profileBox">
      <h2>ã‚ãªãŸã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h2>
      <p id="pStats"></p>
      <button id="closeProfile">é–‰ã˜ã‚‹</button>
    </div>
  </div>

<script>
// Unique Posts Edition: ä¸€åº¦è¡¨ç¤ºã•ã‚ŒãŸãƒã‚¹ãƒˆã¯å†åº¦è¡¨ç¤ºã•ã‚Œãªã„ã‚ˆã†ã«ç®¡ç†

// Player State
const player = {followers:0, influence:0, level:1, commentsMade:0, likesGiven:0};

// å®šç¾©æ¸ˆã¿ãƒã‚¹ãƒˆã¨é¸æŠè‚¢
const postCatalogue = [
  // æ—¢å­˜7ç¨®
  {text:'ä»Šæ—¥ã¯éœ§ãŒæ¿ƒã„ã‚ã­ã€‚æ£®ã®å¥¥ã‹ã‚‰èª°ã‹ã®æ­Œå£°ãŒèã“ãˆã‚‹â€¦ âœ¨', choices:[{text:'ğŸµ ãã®æ­Œå£°æ°—ã«ãªã‚‹ï¼',f:2,i:4},{text:'ğŸ˜± ã¡ã‚‡ã£ã¨ä¸æ°—å‘³â€¦',f:-1,i:2},{text:'ğŸ” èª¿æŸ»ã«è¡Œã“ã†ï¼',f:3,i:3}]},
  {text:'éºè·¡ã§å¤ã„ç«¯æœ«ã‚’æ‹¾ã£ãŸï¼ã§ã‚‚é›»æºã®å…¥ã‚Œæ–¹ãŒåˆ†ã‹ã‚‰ãªã„ã€‚ ğŸ—ºï¸',choices:[{text:'ğŸ’¡ é›»æºãƒœã‚¿ãƒ³æ¢ã—ã¦ã¿ã¦',f:1,i:3},{text:'ğŸ”§ ä¿®ç†æ‰‹ä¼ãŠã†ã‹ï¼Ÿ',f:3,i:4},{text:'ğŸ—‘ï¸ æ—©ãæ¨ã¦ãŸæ–¹ãŒã„ã„ã‹ã‚‚',f:-2,i:1}]},
  {text:'ãƒ‰ãƒ©ã‚´ãƒ³ã®å½±ã‚’è¦‹ãŸã£ã¦å™‚ã€ã¿ã‚“ãªä¿¡ã˜ã‚‹ï¼Ÿ ğŸ‰',choices:[{text:'ğŸ”¥ æœ¬ç‰©ã ã£ãŸã‚‰å¤§ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼',f:4,i:4},{text:'ğŸ¤” ã‚¬ã‚»ã ã¨æ€ã†',f:-1,i:2},{text:'ğŸ›¡ï¸ é€€æ²»ã«è¡Œãã¹ãï¼',f:2,i:3}]},
  {text:'æ—…äººã•ã‚“ã€æ¸©ã‹ã„ã‚¹ãƒ¼ãƒ—ã¯ã„ã‹ãŒï¼Ÿ ğŸ—ºï¸',choices:[{text:'ğŸ² é£²ã¿ãŸã„ï¼',f:3,i:4},{text:'ğŸŒ¡ï¸ æœ¬å½“ã«æš–ã‹ã„ã®ï¼Ÿ',f:1,i:2},{text:'ğŸ§š ãƒ”ã‚¯ã‚·ã•ã‚“ç”Ÿãã¦ãŸã‚“ã ï¼',f:2,i:3}]},
  {text:'æ˜ŸãŒè¿‘ã„å¤œã¯ã€é¡˜ã„äº‹ãŒå¶ã†ã‚‰ã—ã„ã€‚ ğŸŒŸ',choices:[{text:'ğŸŒ  ä½•ã‚’é¡˜ãŠã†ã‹ãª',f:2,i:3},{text:'ğŸ¤·â€â™‚ï¸ ãã‚“ãªã®ä¿¡ã˜ãªã„',f:-1,i:1},{text:'ğŸ“œ å¤ã„ä¼æ‰¿ã‹ã‚‚ã­',f:1,i:2}]},
  {text:'ã‚®ãƒ«ãƒ‰ã«çã—ã„ã‚¯ã‚¨ã‚¹ãƒˆãŒæ¥ãŸã‚ˆã€‚è­·è¡›ã ã‘ã©å±é™ºåº¦Sãƒ©ãƒ³ã‚¯ï¼ ğŸ°',choices:[{text:'ğŸ—¡ï¸ æŒ‘æˆ¦ã—ã‚ˆã†ï¼',f:4,i:4},{text:'ğŸ˜¨ ç„¡ç†ç„¡ç†â€¦',f:-2,i:1},{text:'ğŸ’° å ±é…¬ã¯ï¼Ÿ',f:2,i:3}]},
  {text:'æ–°ã—ã„æ¥½å™¨ã‚’ä½œã£ãŸã‚“ã ã€‚ä»Šåº¦è´ã„ã¦ãã‚Œã‚‹ï¼Ÿ ğŸ»',choices:[{text:'ğŸ¶ ãœã²è´ããŸã„ï¼',f:3,i:3},{text:'ğŸ¤” éŸ³ç¨‹åˆã£ã¦ã‚‹ï¼Ÿ',f:-1,i:2},{text:'ğŸ‘ ç™ºæ˜å®¶ã ã­ï¼',f:2,i:4}]},
  // æ–°è¦10ç¨®
  {text:'æ¹–ã«å·¨å¤§ãªé­šãŒç¾ã‚ŒãŸã‚‰ã—ã„ï¼èª°ã‹è¦‹ãŸï¼Ÿ ğŸŸ',choices:[{text:'ğŸ£ é‡£ã‚Šã«è¡ŒããŸã„ï¼',f:3,i:3},{text:'ğŸ“¸ å†™çœŸã‚ã‚‹ï¼Ÿ',f:2,i:2},{text:'ğŸ˜… ãã‚Œã¯ç››ã‚Šã™ãã§ã¯',f:-1,i:1}]},
  {text:'é­”æ³•ã®èŠ±ãŒå’²ã„ãŸã£ã¦è©±é¡Œã«ãªã£ã¦ã‚‹ã‚ˆã€‚ ğŸŒ¸',choices:[{text:'âœ¨ è¦‹ã«è¡ŒããŸã„ï¼',f:3,i:4},{text:'ğŸ¤” æœ¬å½“ã«å’²ãã®ï¼Ÿ',f:1,i:2},{text:'ğŸ˜¤ ã©ã†ã›ä½œã‚Šè©±',f:-2,i:1}]},
  {text:'è¡—ã®åºƒå ´ã§å ã„å¸«ãŒç„¡æ–™ã§æœªæ¥ã‚’è¦‹ã¦ãã‚Œã‚‹ã£ã¦ï¼ ğŸ”®',choices:[{text:'ğŸ™‹â€â™‚ï¸ å ã£ã¦ã»ã—ã„ï¼',f:3,i:3},{text:'ğŸ¤·â€â™€ï¸ ä¿¡ã˜ãªã„ãªã',f:-1,i:2},{text:'ğŸ‘€ è¡Œåˆ—ã§ãã¦ãŸã‚ˆ',f:2,i:2}]},
  {text:'ä»Šæ—¥ã®æ£®ã¯éœ§ãŒæ·±ã„ã‹ã‚‰æ°—ã‚’ã¤ã‘ã¦ã­ã€‚ ğŸŒ«ï¸',choices:[{text:'ğŸ‘£ è¿‘é“ã—ã¦ã¿ã‚‹',f:2,i:2},{text:'ğŸ™…â€â™€ï¸ è¡Œã‹ãªã„æ–¹ãŒã„ã„',f:1,i:1},{text:'ğŸ˜± æ€–ã„ã‹ã‚‰ã‚„ã‚ã¨ã',f:-1,i:2}]},
  {text:'å¤©ç©ºåŸãŒè¦‹ãˆãŸã£ã¦äººãŒã„ã‚‹ï¼æœ¬å½“ã‹ãªï¼Ÿ ğŸ¯',choices:[{text:'ğŸ‘€ è¦‹ã¦ã¿ãŸã„ï¼',f:3,i:4},{text:'ğŸ¤¨ å¹»è¦šã˜ã‚ƒï¼Ÿ',f:-2,i:1},{text:'ğŸŒˆ å†’é™ºã®äºˆæ„Ÿï¼',f:2,i:3}]},
  {text:'åœ°ä¸‹è¿·å®®ã§ãƒ¬ã‚¢ã‚¢ã‚¤ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã£ãŸã£ã¦ï¼ ğŸ—ï¸',choices:[{text:'ğŸ’ å‚åŠ ã—ãŸã„ï¼',f:3,i:4},{text:'ğŸ˜… è¿·å­ã«ãªã‚Šãã†',f:1,i:2},{text:'ğŸ¤¥ å˜˜ã˜ã‚ƒãªã„ï¼Ÿ',f:-2,i:1}]},
  {text:'ç‚ã®ç¥­ã‚ŠãŒä»Šå¤œé–‹å‚¬ï¼ã¿ã‚“ãªæ¥ã¦ã­ï¼ ğŸ”¥',choices:[{text:'ğŸ•º ç››ã‚Šä¸ŠãŒã‚Šãã†ï¼',f:3,i:3},{text:'ğŸ¥µ ç«ã®ç²‰ã«æ³¨æ„',f:1,i:2},{text:'ğŸ˜‘ ã‚ã¾ã‚Šèˆˆå‘³ãªã„',f:-1,i:1}]},
  {text:'æœˆãŒä»Šæ—¥ã¯ã„ã¤ã‚‚ã‚ˆã‚Šèµ¤ãè¦‹ãˆã‚‹â€¦ä¸å‰ãªäºˆæ„Ÿï¼Ÿ ğŸŒ•',choices:[{text:'ğŸŒ‘ ç¥ç§˜çš„ã ã­',f:2,i:3},{text:'ğŸ˜± ã¡ã‚‡ã£ã¨æ€–ã„',f:1,i:1},{text:'ğŸ¤£ ãŸã ã®æ°—ã®ã›ã„',f:-1,i:1}]},
  {text:'æ¸¯ç”ºã§æ–°ã—ã„å¸‚å ´ãŒã‚ªãƒ¼ãƒ—ãƒ³ã—ãŸã‚‰ã—ã„ï¼ ğŸª',choices:[{text:'ğŸ›ï¸ è¡Œã£ã¦ã¿ãŸã„ï¼',f:3,i:2},{text:'ğŸ´ ç¾å‘³ã—ã„ã‚‚ã®ã‚ã‚Šãã†',f:2,i:3},{text:'ğŸ’¸ ç¯€ç´„ä¸­ã ã‹ã‚‰ç„¡ç†',f:-1,i:1}]},
  {text:'ç ‚æ¼ ã§ã‚ªã‚¢ã‚·ã‚¹ã‚’ç™ºè¦‹ã—ãŸæ—…äººãŒã„ã‚‹ãã†ï¼ ğŸœï¸',choices:[{text:'ğŸ’§ è¡Œã£ã¦ã¿ãŸã„',f:3,i:3},{text:'ğŸ§­ é“ã«è¿·ã„ãã†',f:1,i:1},{text:'ğŸ¦´ å¹»ã ã‚ˆãŸã¶ã‚“',f:-1,i:1}]}
];

// availableã‹ã‚‰ä¸€åº¦ãã‚Šã§æŠ½å‡º
let availableCatalogue = [...postCatalogue];
let postId = 0;
const posts = [];

// DOM refs
const statsDiv = document.getElementById('stats');
const feedSec = document.getElementById('feed');
const levelUpDiv = document.getElementById('levelUp');
const loaderDiv = document.getElementById('loader');
const profileBtn = document.getElementById('profileBtn');
const overlay = document.getElementById('profileOverlay');
const pStats = document.getElementById('pStats');
const closeProfile = document.getElementById('closeProfile');

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
const randIndex = len => Math.floor(Math.random()*len);

// ãƒã‚¹ãƒˆç”Ÿæˆï¼ˆä¸€åº¦ãã‚Šï¼‰
function createPost(){
  if(availableCatalogue.length===0) return null;
  const idx = randIndex(availableCatalogue.length);
  const base = availableCatalogue.splice(idx,1)[0];
  const p = JSON.parse(JSON.stringify(base));
  p.id = ++postId;
  p.likes = 0;
  p.comments = [];
  p.liked = false;
  p.commented = false;
  return p;
}

function renderStats(){
  statsDiv.innerHTML = `<strong>Followers:</strong> ${player.followers} &nbsp; | &nbsp; ` +
                       `<strong>Influence:</strong> ${player.influence} &nbsp; | &nbsp; ` +
                       `<strong>LV:</strong> ${player.level}`;
}

function checkLevelUp(){
  const need = player.level * 20;
  if(player.influence >= need){
    player.level++;
    player.influence = 0;
    levelUpDiv.style.display = 'block';
    levelUpDiv.textContent = `ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ LV${player.level}`;
    for(let i=0;i<3;i++){
      const n = createPost();
      if(n) posts.unshift(n);
    }
    renderFeed();
    setTimeout(()=> levelUpDiv.style.display = 'none', 4000);
  }
}

function likePost(id){
  const p = posts.find(x=>x.id===id);
  if(!p || p.liked) return;
  p.likes++;
  p.liked = true;
  player.followers += 1 + Math.floor(player.level/2);
  player.influence += 2;
  player.likesGiven++;
  renderFeed(); renderStats(); checkLevelUp();
}

function commentPost(id){
  const p = posts.find(x=>x.id===id);
  if(!p || p.commented) return;
  const existing = document.querySelector(`.choiceBox[data-post="${id}"]`);
  if(existing){ existing.remove(); return; }
  const art = feedSec.querySelector(`article[data-id="${id}"]`);
  const box = document.createElement('div');
  box.className = 'choiceBox';
  box.dataset.post = id;
  p.choices.forEach(ch => {
    const btn = document.createElement('button');
    btn.textContent = ch.text;
    btn.onclick = () => { applyChoice(p, ch); box.remove(); };
    box.appendChild(btn);
  });
  art.appendChild(box);
}

function applyChoice(post, ch){
  post.comments.push(ch.text);
  post.commented = true;
  player.followers = Math.max(0, player.followers + ch.f);
  player.influence += ch.i;
  player.commentsMade++;
  renderFeed(); renderStats(); checkLevelUp();
}

function renderFeed(){
  feedSec.innerHTML = '';
  posts.slice(0,20).forEach(p => {
    const art = document.createElement('article');
    art.dataset.id = p.id;
    art.innerHTML = `<div class="author">NPC</div><div class="msg">${p.text}</div>` +
                    `<div class="actions">` +
                    `<button class="like ${p.liked?'liked':''}">ã„ã„ã­ ${p.likes}</button>` +
                    `<button class="comment">ã‚³ãƒ¡ãƒ³ãƒˆ ${p.comments.length}</button>` +
                    `</div>`;
    art.querySelector('.like').onclick = () => likePost(p.id);
    art.querySelector('.comment').onclick = () => commentPost(p.id);
    feedSec.appendChild(art);
  });
}

// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ«
function openProfile(){
  pStats.innerHTML = `<strong>Followers:</strong> ${player.followers}<br>`+
                     `<strong>Influence:</strong> ${player.influence}<br>`+
                     `<strong>Level:</strong> ${player.level}<br>`+
                     `<strong>Likes Given:</strong> ${player.likesGiven}<br>`+
                     `<strong>Comments Made:</strong> ${player.commentsMade}`;
  overlay.style.display = 'flex';
}
function closeProfileModal(){ overlay.style.display = 'none'; }
profileBtn.onclick = openProfile;
closeProfile.onclick = closeProfileModal;
overlay.onclick = e => { if(e.target===overlay) closeProfileModal(); };

// boot
window.addEventListener('DOMContentLoaded', ()=>{
  for(let i=0;i<5;i++){
    const n = createPost();
    if(n) posts.push(n);
  }
  renderStats(); renderFeed(); loaderDiv.style.display='none';
});

// ãƒ†ã‚¹ãƒˆ
console.assert(new Set(posts.map(p=>p.text)).size === posts.length, 'åˆæœŸãƒã‚¹ãƒˆã¯é‡è¤‡ãªã—');
console.assert(availableCatalogue.length === postCatalogue.length - posts.length, 'availableCatalogue æ›´æ–°');
</script>
</body>
</html>